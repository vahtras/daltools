import os
import numpy as np
from util.full import init
from daltools import prop

def setup():
    global tmpdir
    n, e = os.path.splitext(__file__)
    tmpdir = n + ".d"

def assert_(this, ref):
    print this
    print ref
    assert np.allclose(this, ref)

def test_X1():
    ref = init([
         0.09427434,
        -0.00000359,
         0.00000001,
         0.00000116,
        -0.14195121,
         0.00001165,
        -0.00000015,
         0.00000035,
         0.19181701,
        -0.00000110,
        -0.00000014,
        -0.00000096,
        -1.24234366,
        -0.00000347,
         0.00000025,
         0.00001722,
        -0.00614442,
         0.00000019,
        -0.00008958,
        -0.00000345,
         0.26392621,
        -0.00004092,
        -0.00000068,
         0.00003122,
        -0.00007309,
        -0.44783871,
         0.01269905,
        -0.29218695,
         0.00238885,
         0.00000024,
         0.00006307,
         0.00000232,
        -0.09427434,
         0.00000359,
        -0.00000001,
        -0.00000116,
         0.14195121,
        -0.00001165,
         0.00000015,
        -0.00000035,
        -0.19181701,
         0.00000110,
         0.00000014,
         0.00000096,
         1.24234366,
         0.00000347,
        -0.00000025,
        -0.00001722,
         0.00614442,
        -0.00000019,
         0.00008958,
         0.00000345,
        -0.26392621,
         0.00004092,
         0.00000068,
        -0.00003122,
         0.00007309,
         0.44783871,
        -0.01269905,
         0.29218695,
        -0.00238885,
        -0.00000024,
        -0.00006307,
        -0.00000232,
        ])
    this,  = prop.grad('XDIPLEN', tmpdir=tmpdir)
    assert_(this, ref)

if __name__ == "__main__":
    setup()
    test_X1()
